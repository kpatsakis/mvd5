static brcmf_cfg80211_escan_handler(struct brcmf_if const struct brcmf_event_msg *e, void *data) struct brcmf_cfg80211_info * cfg = ifp -> drvr -> config ; s32 status ; struct brcmf_escan_result_le * escan_result_le ; struct brcmf_bss_info_le * bss_info_le ; struct brcmf_bss_info_le * bss = NULL ; u32 bi_length ; struct brcmf_scan_results * list ; u32 i ; status = e -> status; if ( ! test_bit ( BRCMF_SCAN_STATUS_BUSY , & cfg -> scan_status ) )  if ( status == BRCMF_E_STATUS_PARTIAL )  escan_result_le = ( struct brcmf_escan_result_le * ) data; if ( ! escan_result_le )  if ( le16_to_cpu ( escan_result_le -> bss_count ) != 1 )  bss_info_le = & escan_result_le -> bss_info_le; if ( brcmf_p2p_scan_finding_common_channel ( cfg , bss_info_le ) )  if ( ! cfg -> scan_request )  bi_length = le32_to_cpu ( bss_info_le -> length ); if ( bi_length != ( le32_to_cpu ( escan_result_le -> buflen ) - WL_ESCAN_RESULTS_FIXED_SIZE ) )  if ( ! ( cfg_to_wiphy ( cfg ) -> interface_modes & BIT ( NL80211_IFTYPE_ADHOC ) ) )  if ( le16_to_cpu ( bss_info_le -> capability ) & WLAN_CAPABILITY_IBSS )  list = ( struct brcmf_scan_results * ) cfg -> escan_info . escan_buf; if ( bi_length > BRCMF_ESCAN_BUF_SIZE - list -> buflen )  for (i = 0; i < list->count; i++) bss = bss ? ( struct brcmf_bss_info_le * ) ( ( unsigned char * ) bss + le32_to_cpu ( bss -> length ) ) : list -> bss_info_le; if ( brcmf_compare_update_same_bss ( cfg , bss , bss_info_le ) )  static brcmf_compare_update_same_bss(struct brcmf_cfg80211_info struct brcmf_bss_info_le struct brcmf_bss_info_le *bss_info_le) struct brcmu_chan ch_bss , ch_bss_info_le ; ch_bss . chspec = le16_to_cpu ( bss -> chanspec ); ch_bss_info_le . chspec = le16_to_cpu ( bss_info_le -> chanspec ); if ( ! memcmp ( & bss_info_le -> BSSID , & bss -> BSSID , ETH_ALEN ) && ch_bss . band == ch_bss_info_le . band && bss_info_le -> SSID_len == bss -> SSID_len && ! memcmp ( bss_info_le -> SSID , bss -> SSID , bss_info_le -> SSID_len ) )  