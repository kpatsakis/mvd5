static int CVE_2014_8709_PATCHED_ieee80211_fragment(struct ieee80211_tx_data struct sk_buff *skb, int int frag_threshold) struct ieee80211_local * local = tx -> local ; struct sk_buff * tmp ; int per_fragm = frag_threshold - hdrlen - FCS_LEN ; int pos = hdrlen + per_fragm ; int rem = skb -> len - hdrlen - per_fragm ; if ( WARN_ON ( rem < 0 ) )  while ( rem )  int fraglen = per_fragm ; if ( fraglen > rem )  fraglen = rem; rem -= fraglen; tmp = dev_alloc_skb ( local -> tx_headroom + frag_threshold + IEEE80211_ENCRYPT_HEADROOM + IEEE80211_ENCRYPT_TAILROOM ); if ( ! tmp )  memcpy ( tmp -> cb , skb -> cb , sizeof ( tmp -> cb ) ); tmp -> priority = skb -> priority; tmp -> dev = skb -> dev; memcpy ( skb_put ( tmp , hdrlen ) , skb -> data , hdrlen ); memcpy ( skb_put ( tmp , fraglen ) , skb -> data + pos , fraglen ); pos += fraglen; 