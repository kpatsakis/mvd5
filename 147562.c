static int CVE_2014_8546_VULN_cinepak_decode_vectors (CinepakContext *s, cvid_strip int chunk_id, int size, const uint8_t *data) const uint8_t * eod = ( data + size ) ; uint32_t flag , mask ; uint8_t * cb0 , * cb1 , * cb2 , * cb3 ; unsigned int x , y ; char * ip0 , * ip1 , * ip2 , * ip3 ; flag = 0; mask = 0; for (y=strip->y1; y < strip->y2; y+=4) ip0 = ip1 = ip2 = ip3 = s -> frame -> data [ 0 ] + ( s -> palette_video ? strip -> x1 : strip -> x1 * 3 ) + ( y * s -> frame -> linesize [ 0 ] ); if ( s -> avctx -> height - y > 1 )  ip1 = ip0 + s -> frame -> linesize [ 0 ]; if ( s -> avctx -> height - y > 2 )  ip2 = ip1 + s -> frame -> linesize [ 0 ]; for (x=strip->x1; x < strip->x2; x+=4) if ( ( chunk_id & 0x01 ) && ! ( mask >>= 1 ) )  if ( ( data + 4 ) > eod )  flag = AV_RB32 ( data ); data += 4; mask = 0x80000000; if ( ! ( chunk_id & 0x01 ) || ( flag & mask ) )  if ( ! ( chunk_id & 0x02 ) && ! ( mask >>= 1 ) )  if ( ( data + 4 ) > eod )  flag = AV_RB32 ( data ); data += 4; mask = 0x80000000; if ( ( chunk_id & 0x02 ) || ( ~flag & mask ) )  uint8_t * p ; if ( data >= eod )  p = strip -> v1_codebook [ * data ++ ]; ip3 [ 0 ] = ip3 [ 1 ] = ip2 [ 0 ] = ip2 [ 1 ] = p [ 6 ]; ip3 [ 2 ] = ip3 [ 3 ] = ip2 [ 2 ] = ip2 [ 3 ] = p [ 9 ]; ip1 [ 0 ] = ip1 [ 1 ] = ip0 [ 0 ] = ip0 [ 1 ] = p [ 0 ]; ip1 [ 2 ] = ip1 [ 3 ] = ip0 [ 2 ] = ip0 [ 3 ] = p [ 3 ]; memcpy ( ip2 + 0 , p , 3 ); memcpy ( ip2 + 3 , p , 3 ); memcpy ( ip2 + 6 , p , 3 ); memcpy ( ip2 + 9 , p , 3 ); if ( flag & mask )  if ( ( data + 4 ) > eod )  cb0 = strip -> v4_codebook [ * data ++ ]; cb1 = strip -> v4_codebook [ * data ++ ]; cb2 = strip -> v4_codebook [ * data ++ ]; cb3 = strip -> v4_codebook [ * data ++ ]; if ( s -> palette_video )  p = ip2; * p ++ = cb2 [ 0 ]; * p ++ = cb2 [ 3 ]; * p ++ = cb3 [ 0 ]; * p = cb3 [ 3 ]; * p ++ = cb0 [ 6 ]; * p ++ = cb0 [ 9 ]; * p ++ = cb1 [ 6 ]; * p = cb1 [ 9 ]; * p ++ = cb0 [ 0 ]; * p ++ = cb0 [ 3 ]; * p ++ = cb1 [ 0 ]; * p = cb1 [ 3 ]; memcpy ( ip2 + 0 , cb2 + 0 , 6 ); memcpy ( ip2 + 6 , cb3 + 0 , 6 ); if ( s -> palette_video )  ip2 += 4; ip2 += 12; 