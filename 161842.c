 CVE_2013_1726_VULN_mar_read_product_info_block(MarFile struct ProductInformationBlock *infoBlock) int i , hasAdditionalBlocks , offset , offsetAdditionalBlocks , numAdditionalBlocks , additionalBlockSize , additionalBlockID ; char buf [ 97 ] = { '\0' } ; for (i = 0; i < numAdditionalBlocks; ++i) if ( fread ( & additionalBlockSize , sizeof ( additionalBlockSize ) , 1 , mar -> fp ) != 1 )  additionalBlockSize = ntohl ( additionalBlockSize ) - sizeof ( additionalBlockSize ) - sizeof ( additionalBlockID ); if ( fread ( & additionalBlockID , sizeof ( additionalBlockID ) , 1 , mar -> fp ) != 1 )  additionalBlockID = ntohl ( additionalBlockID ); if ( PRODUCT_INFO_BLOCK_ID == additionalBlockID )  const char * location ; int len ; if ( additionalBlockSize > 96 )  if ( fread ( buf , additionalBlockSize , 1 , mar -> fp ) != 1 )  location = buf; len = strlen ( location ); location += len + 1; if ( len >= 64 )  len = strlen ( location ); location += len + 1; if ( len >= 32 )  if ( fseek ( mar -> fp , additionalBlockSize , SEEK_CUR ) )  