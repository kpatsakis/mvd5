static int CVE_2011_2529_VULN_sipsock_read(int *id, int fd, short events, void *ignore) struct sip_request req ; memset ( & req , 0 , sizeof ( req ) ); if ( ! ( req . data = ast_str_create ( SIP_MIN_PACKET ) ) )  if ( ast_str_set ( & req . data , 0 , "%s" , readbuf ) == AST_DYNSTR_BUILD_FAILED )  req . len = res; req . socket . fd = sipsock; set_socket_transport ( & req . socket , SIP_TRANSPORT_UDP ); req . socket . tcptls_session = NULL; req . socket . port = htons ( ast_sockaddr_port ( & bindaddr ) ); handle_request_do ( & req , & addr ); deinit_req ( & req ); 