static int CVE_2012_3364_VULN_nci_extract_activation_params_iso_dep(struct nci_dev struct nci_rf_intf_activated_ntf *ntf, __u8 *data) struct activation_params_nfca_poll_iso_dep * nfca_poll ; struct activation_params_nfcb_poll_iso_dep * nfcb_poll ; switch ( ntf -> activation_rf_tech_and_mode )  nfca_poll = & ntf -> activation_params . nfca_poll_iso_dep; nfca_poll -> rats_res_len = * data ++; nfcb_poll = & ntf -> activation_params . nfcb_poll_iso_dep; nfcb_poll -> attrib_res_len = * data ++; if ( nfcb_poll -> attrib_res_len > 0 )  memcpy ( nfcb_poll -> attrib_res , data , nfcb_poll -> attrib_res_len ); 