static int CVE_2011_4087_PATCHED_br_parse_ip_options(struct sk_buff *skb) struct iphdr * iph ; u32 len ; iph = ip_hdr ( skb ); if ( iph -> ihl < 5 || iph -> version != 4 )  if ( ! pskb_may_pull ( skb , iph -> ihl * 4 ) )  iph = ip_hdr ( skb ); if ( unlikely ( ip_fast_csum ( ( u8 * ) iph , iph -> ihl ) ) )  len = ntohs ( iph -> tot_len ); if ( skb -> len < len )  if ( len < ( iph -> ihl * 4 ) )  if ( pskb_trim_rcsum ( skb , len ) )  memset ( IPCB ( skb ) , 0 , sizeof ( struct inet_skb_parm ) ); 