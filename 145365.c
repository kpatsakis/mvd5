static int aes_gcm_cipher(EVP_CIPHER_CTX *ctx,unsigned char *out,const unsigned char *in,size_t len) EVP_AES_GCM_CTX * gctx = ( ctx -> cipher_data ) ; if ( ! gctx -> key_set )  if ( gctx -> tls_aad_len >= 0 )  return aes_gcm_tls_cipher ( ctx , out , in , len ) ; static int aes_gcm_tls_cipher(EVP_CIPHER_CTX *ctx,unsigned char *out,const unsigned char *in,size_t len) EVP_AES_GCM_CTX * gctx = ( ctx -> cipher_data ) ; if ( out != in || len < ( 8 + 16 ) )  if ( EVP_CIPHER_CTX_ctrl ( ctx , ( ctx -> encrypt ? 0x13 : 0x18 ) , 8 , out ) <= 0 )  if ( CRYPTO_gcm128_aad ( & gctx -> gcm , ( ctx -> buf ) , ( gctx -> tls_aad_len ) ) )  in += 8; out += 8; len -= ( 8 + 16 ); if ( ctx -> encrypt )  if ( gctx -> ctr )  if ( CRYPTO_gcm128_decrypt_ctr32 ( & gctx -> gcm , in , out , len , gctx -> ctr ) )  if ( CRYPTO_gcm128_decrypt ( & gctx -> gcm , in , out , len ) )  if ( memcmp ( ( ctx -> buf ) , ( in + len ) , 16 ) )  