static int aes_gcm_ctrl(EVP_CIPHER_CTX *c,int type,int arg,void *ptr) EVP_AES_GCM_CTX * gctx = ( c -> cipher_data ) ; switch ( type )  gctx -> key_set = 0; gctx -> iv_set = 0; gctx -> ivlen = c -> cipher -> iv_len; gctx -> iv = c -> iv; gctx -> taglen = - 1; gctx -> iv_gen = 0; gctx -> tls_aad_len = - 1; if ( arg <= 0 )  if ( arg > 16 && arg > gctx -> ivlen )  gctx -> iv = ( CRYPTO_malloc ( ( ( int ) arg ) , "e_aes.c" , 728 ) ); if ( ! gctx -> iv )  gctx -> ivlen = arg; if ( arg <= 0 || arg > 16 || c -> encrypt )  memcpy ( ( c -> buf ) , ptr , arg ); gctx -> taglen = arg; if ( arg <= 0 || arg > 16 || ! c -> encrypt || gctx -> taglen < 0 )  memcpy ( ptr , ( c -> buf ) , arg ); if ( arg == - 1 )  memcpy ( ( gctx -> iv ) , ptr , ( gctx -> ivlen ) ); gctx -> iv_gen = 1; 