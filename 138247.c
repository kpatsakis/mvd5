static CVE_2012_1594_PATCHED_dissect_ieee80211_common (tvbuff_t * tvb, packet_info * proto_tree * tree, gboolean fixed_length_header, gint gboolean wlan_broken_fc, gboolean gboolean is_ht) guint16 fcf , flags , frame_type_subtype , ctrl_fcf , ctrl_type_subtype ; const guint8 * src = NULL ; const guint8 * bssid = NULL ; proto_tree * volatile hdr_tree = NULL guint32 addr_type ; const char * addr1_str = NULL ; guint offset ; const gchar * fts_str ; fcf = FETCH_FCF ( 0 ); frame_type_subtype = COMPOSE_FRAME_TYPE ( fcf ); if ( frame_type_subtype == CTRL_CONTROL_WRAPPER )  ctrl_fcf = FETCH_FCF ( 10 ); ctrl_fcf = 0; if ( fixed_length_header )  hdr_len = DATA_LONG_HDR_LEN; hdr_len = find_header_length ( fcf , ctrl_fcf , is_ht ); if ( datapad )  hdr_len = roundup2 ( hdr_len , 4 ); fts_str = val_to_str_const ( frame_type_subtype , frame_type_subtype_vals , "Unrecognized (Reserved frame)" ); if ( tree )  ti = proto_tree_add_protocol_format ( tree , proto_wlan , tvb , 0 , hdr_len , "IEEE 802.11 %s" , fts_str ); hdr_tree = proto_item_add_subtree ( ti , ett_80211 ); switch ( FCF_FRAME_TYPE ( fcf ) )  src = tvb_get_ptr ( tvb , 10 , 6 ); if ( frame_type_subtype == CTRL_CONTROL_WRAPPER )  offset = 10; ctrl_fcf = FETCH_FCF ( 10 ); ctrl_type_subtype = COMPOSE_FRAME_TYPE ( ctrl_fcf ); offset = 10; ctrl_type_subtype = frame_type_subtype; switch ( ctrl_type_subtype )  addr1_str = "BSSID"; addr1_str = "RA"; if ( ! addr1_str )  if ( frame_type_subtype == CTRL_CONTROL_WRAPPER && tree )  cw_item = proto_tree_add_text ( hdr_tree , tvb , offset , 2 , "Contained Frame Control" ); offset += 6; cw_item = proto_tree_add_text ( hdr_tree , tvb , offset , 2 , "Carried Frame" ); hdr_tree = proto_item_add_subtree ( cw_item , ett_cntrl_wrapper_fc ); switch ( ctrl_type_subtype )  src = tvb_get_ptr ( tvb , offset , 6 ); src = tvb_get_ptr ( tvb , offset , 6 ); src = tvb_get_ptr ( tvb , offset , 6 ); if ( tree )  guint16 bar_control ; guint8 block_ack_type ; proto_item * bar_parent_item ; offset += 6; bar_control = tvb_get_letohs ( tvb , offset ); block_ack_type = ( bar_control & 0x0006 ) >> 1; switch ( block_ack_type )  offset += 2; offset += add_fixed_field ( hdr_tree , tvb , offset , FIELD_BLOCK_ACK_SSC ); guint8 tid_count , i ; proto_tree * bar_mtid_tree , * bar_mtid_sub_tree ; tid_count = ( ( bar_control & 0xF000 ) >> 12 ) + 1; offset += 2; bar_parent_item = proto_tree_add_text ( hdr_tree , tvb , offset , tid_count * 4 , "Per TID Info" ); bar_mtid_tree = proto_item_add_subtree ( bar_parent_item , ett_block_ack ); for (i = 1; i <= tid_count; i++) bar_parent_item = proto_tree_add_uint ( bar_mtid_tree , hf_ieee80211_block_ack_multi_tid_info , tvb , offset , 4 , i ); bar_mtid_sub_tree = proto_item_add_subtree ( bar_parent_item , ett_block_ack ); offset += 2; offset += add_fixed_field ( bar_mtid_sub_tree , tvb , offset , FIELD_BLOCK_ACK_SSC ); src = tvb_get_ptr ( tvb , offset , 6 ); addr_type = FCF_ADDR_SELECTOR ( fcf ); switch ( addr_type )  src = tvb_get_ptr ( tvb , 10 , 6 ); bssid = tvb_get_ptr ( tvb , 16 , 6 ); src = tvb_get_ptr ( tvb , 16 , 6 ); bssid = tvb_get_ptr ( tvb , 10 , 6 ); src = tvb_get_ptr ( tvb , 10 , 6 ); bssid = tvb_get_ptr ( tvb , 4 , 6 ); src = tvb_get_ptr ( tvb , 24 , 6 ); bssid = tvb_get_ptr ( tvb , 16 , 6 ); switch ( FCF_FRAME_TYPE ( fcf ) )  if ( DATA_FRAME_IS_NULL ( frame_type_subtype ) )  if ( ! wlan_subdissector )  if ( ! pinfo -> fd -> flags . visited )  retransmit_key key ; memcpy ( key . bssid , bssid , 6 ); memcpy ( key . src , src , 6 ); key . seq_control = 0; result = ( retransmit_key * ) g_hash_table_lookup ( fc_analyse_retransmit_table , & key ); if ( result && result -> seq_control == seq_control )  fnum = result -> fnum; g_hash_table_insert ( fc_first_frame_table , GINT_TO_POINTER ( pinfo -> fd -> num ) , GINT_TO_POINTER ( fnum ) ); if ( ! result )  * result = key; g_hash_table_insert ( fc_analyse_retransmit_table , result , result ); result -> seq_control = seq_control; result -> fnum = pinfo -> fd -> num; item = proto_tree_add_uint ( hdr_tree , hf_ieee80211_fc_analysis_retransmission_frame , tvb , 0 , 0 , fnum ); PROTO_ITEM_SET_GENERATED ( item ); proto_tree_add_uint ( wep_tree , hf_ieee80211_wep_key , tvb , hdr_len + 3 , 1 , key ); proto_tree_add_uint ( wep_tree , hf_ieee80211_wep_key , tvb , hdr_len + 3 , 1 , key ); 