static int CVE_2013_3674_VULN_cdg_decode_frame(AVCodecContext void *data, int *got_frame, AVPacket *avpkt) int buf_size = avpkt -> size ; int ret ; uint8_t command , inst ; uint8_t cdg_data [ CDG_DATA_SIZE ] ; CDGraphicsContext * cc = avctx -> priv_data ; if ( buf_size < CDG_MINIMUM_PKT_SIZE )  if ( buf_size > CDG_HEADER_SIZE + CDG_DATA_SIZE )  ret = avctx -> reget_buffer ( avctx , & cc -> frame ); if ( ret )  if ( ! avctx -> frame_number )  memset ( cc -> frame . data [ 0 ] , 0 , cc -> frame . linesize [ 0 ] * avctx -> height ); memset ( cc -> frame . data [ 1 ] , 0 , AVPALETTE_SIZE ); command = bytestream_get_byte ( & buf ); inst = bytestream_get_byte ( & buf ); inst &= CDG_MASK; if ( ( command & CDG_MASK ) == CDG_COMMAND )  switch ( inst )  if ( ! ( cdg_data [ 1 ] & 0x0F ) )  memset ( cc -> frame . data [ 0 ] , cdg_data [ 0 ] & 0x0F , cc -> frame . linesize [ 0 ] * CDG_FULL_HEIGHT ); avctx -> release_buffer ( avctx , & cc -> frame ); 