int __key_link_check_live_key(struct key *keyring, struct key *key) if ( key -> type == & key_type_keyring )  return keyring_detect_cycle ( keyring , key ) ; static int keyring_detect_cycle(struct key *A, struct key *B) struct keyring_search_context ctx . index_key = A -> index_key . match_data . raw_data = A . match_data . lookup_type = KEYRING_SEARCH_LOOKUP_DIRECT . iterator = keyring_detect_cycle_iterator . flags = ( KEYRING_SEARCH_NO_STATE_CHECK KEYRING_SEARCH_NO_UPDATE_TIME KEYRING_SEARCH_NO_CHECK_PERM KEYRING_SEARCH_DETECT_TOO_DEEP ) , search_nested_keyrings ( B , & ctx ); static bool search_nested_keyrings(struct key struct keyring_search_context *ctx) if ( ctx -> index_key . description )  ctx -> index_key . desc_len = strlen ( ctx -> index_key . description ); if ( ctx -> match_data . lookup_type == KEYRING_SEARCH_LOOKUP_ITERATE || keyring_compare_object ( keyring , & ctx -> index_key ) )  static bool keyring_compare_object(const void *object, const void *data) const struct keyring_index_key * index_key = data ; const struct key * key = keyring_ptr_to_key ( object ) ; return key -> index_key . type == index_key -> type && key -> index_key . desc_len == index_key -> desc_len && memcmp ( key -> index_key . description , index_key -> description , index_key -> desc_len ) == 0 ; 