 apr_status_t CVE_2010_2068_PATCHED_ap_proxy_http_process_response(apr_pool_t * p, request_rec proxy_conn_rec conn_rec proxy_server_conf char *server_portstr) char buffer [ HUGE_STRING_LEN ] ; char keepchar ; int len , backasswards ; int interim_response = 0 ; apr_table_t * save_table ; if ( len <= 0 )  if ( apr_date_checkmask ( buffer , "HTTP/#.# ###*" ) )  int major , minor ; if ( 2 != sscanf ( buffer , "HTTP/%u.%u" , & major , & minor ) )  keepchar = buffer [ 12 ]; buffer [ 12 ] = '\0'; r -> status = atoi ( & buffer [ 9 ] ); if ( keepchar != '\0' )  buffer [ 12 ] = keepchar; buffer [ 12 ] = ' '; buffer [ 13 ] = '\0'; r -> status_line = apr_pstrdup ( p , & buffer [ 9 ] ); save_table = apr_table_make ( r -> pool , 2 ); if ( r -> headers_out == NULL )  if ( ! apr_is_empty_table ( save_table ) )  r -> headers_out = apr_table_overlay ( r -> pool , r -> headers_out , save_table ); r -> headers_out = ap_proxy_clean_warnings ( p , r -> headers_out ); r -> status = 200; r -> status_line = "200 OK"; if ( ap_is_HTTP_INFO ( r -> status ) )  interim_response ++; interim_response = 0; while ( interim_response && ( interim_response < AP_MAX_INTERIM_RESPONSES ) )  