 CVE_2014_3640_VULN_udp_input(register struct mbuf *m, int iphlen) register struct ip * ip register struct udphdr * uh ; int len ; if ( iphlen > sizeof ( struct ip ) )  iphlen = sizeof ( struct ip ); ip = mtod ( m , struct ip * ) uh = ( struct udphdr * ) ( ( caddr_t ) ip + iphlen ); len = ntohs ( ( u_int16_t ) uh -> uh_ulen ); if ( ip -> ip_len != len )  if ( len > ip -> ip_len )  ip -> ip_len = len; if ( uh -> uh_sum )  memset ( & ( ( struct ipovly * ) ip ) -> ih_mbuf , 0 , sizeof ( struct mbuf_ptr ) ); 