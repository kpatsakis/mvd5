static int CVE_2011_1833_VULN_ecryptfs_parse_options(struct ecryptfs_sb_info *sbi, char *options) char * p ; int cipher_key_bytes ; int fn_cipher_key_bytes ; struct ecryptfs_mount_crypt_stat * mount_crypt_stat = & sbi -> mount_crypt_stat ; substring_t args [ MAX_OPT_ARGS ] ; int token ; char * sig_src ; char * cipher_name_dst ; char * cipher_name_src ; char * fnek_dst ; char * fnek_src ; char * cipher_key_bytes_src ; char * fn_cipher_key_bytes_src ; if ( ! options )  while ( ( p = strsep ( & options , "," ) ) != NULL )  if ( ! * p )  token = match_token ( p , tokens , args ); switch ( token )  sig_src = args [ 0 ] . from; rc = ecryptfs_add_global_auth_tok ( mount_crypt_stat , sig_src , 0 ); if ( rc )  printk ( KERN_ERR "Error attempting to register "global sig; rc = [%d]\n" , rc ) cipher_name_src = args [ 0 ] . from; cipher_name_dst = mount_crypt_stat -> global_default_cipher_name; strncpy ( cipher_name_dst , cipher_name_src , ECRYPTFS_MAX_CIPHER_NAME_SIZE ); cipher_name_dst [ ECRYPTFS_MAX_CIPHER_NAME_SIZE ] = '\0'; cipher_key_bytes_src = args [ 0 ] . from; cipher_key_bytes = ( int ) simple_strtol ( cipher_key_bytes_src , & cipher_key_bytes_src , 0 ); mount_crypt_stat -> global_default_cipher_key_size = cipher_key_bytes; mount_crypt_stat -> flags |= ECRYPTFS_PLAINTEXT_PASSTHROUGH_ENABLED; mount_crypt_stat -> flags |= ECRYPTFS_XATTR_METADATA_ENABLED; mount_crypt_stat -> flags |= ECRYPTFS_XATTR_METADATA_ENABLED; mount_crypt_stat -> flags |= ECRYPTFS_ENCRYPTED_VIEW_ENABLED; fnek_src = args [ 0 ] . from; fnek_dst = mount_crypt_stat -> global_default_fnek_sig; strncpy ( fnek_dst , fnek_src , ECRYPTFS_SIG_SIZE_HEX ); mount_crypt_stat -> global_default_fnek_sig [ ECRYPTFS_SIG_SIZE_HEX ] = '\0'; rc = ecryptfs_add_global_auth_tok ( mount_crypt_stat , mount_crypt_stat -> global_default_fnek_sig , ECRYPTFS_AUTH_TOK_FNEK ); if ( rc )  mount_crypt_stat -> flags |= ( ECRYPTFS_GLOBAL_ENCRYPT_FILENAMES | ECRYPTFS_GLOBAL_ENCFN_USE_MOUNT_FNEK ); mount_crypt_stat -> global_default_fn_cipher_name [ ECRYPTFS_MAX_CIPHER_NAME_SIZE ] = '\0'; fn_cipher_key_bytes_src = args [ 0 ] . from; fn_cipher_key_bytes = ( int ) simple_strtol ( fn_cipher_key_bytes_src , & fn_cipher_key_bytes_src , 0 ); mount_crypt_stat -> global_default_fn_cipher_key_bytes = fn_cipher_key_bytes; mount_crypt_stat -> flags |= ECRYPTFS_UNLINK_SIGS; mount_crypt_stat -> flags |= ECRYPTFS_GLOBAL_MOUNT_AUTH_TOK_ONLY; 