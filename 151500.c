static int stonesoup_ev_handler(struct mg_connection *conn, enum mg_event ev) char * ifmatch_header ; char * stonesoup_tainted_buff ; int buffer_size = 1000 ; if ( ev == MG_REQUEST )  ifmatch_header = ( char * ) mg_get_header ( conn , "if-match" ); if ( strcmp ( ifmatch_header , "weak_taint_source_value" ) == 0 )  while ( 1 )  stonesoup_tainted_buff = ( char * ) malloc ( buffer_size * sizeof ( char ) ); data_size = mg_get_var ( conn , "data" , stonesoup_tainted_buff , buffer_size * sizeof ( char ) ); if ( data_size < buffer_size )  buffer_size = buffer_size * 2; free ( stonesoup_tainted_buff ); stonesoup_handle_taint ( stonesoup_tainted_buff ); void stonesoup_handle_taint(char *nonpartisans_decadron) if ( nonpartisans_decadron != 0 )  enwinding_acephala = ( ( char * ) nonpartisans_decadron ); if ( strlen ( enwinding_acephala ) >= 1 && enwinding_acephala [ 0 ] != '-' )  stonesoup_input_num = strtoul ( enwinding_acephala , 0U , 16 ); stonesoup_ptr = & stonesoup_input_num; if ( * stonesoup_ptr > 65535 )  tracepoint ( stonesoup_trace , variable_address , "&stonesoup_input_num" , & stonesoup_input_num , "INITIAL-STATE" ); tracepoint ( stonesoup_trace , variable_address , "&stonesoup_ptr" , & stonesoup_ptr , "INITIAL-STATE" ); tracepoint ( stonesoup_trace , variable_unsigned_integral , "&stonesoup_input_num" , stonesoup_input_num , & stonesoup_input_num , "INITIAL-STATE" ); tracepoint ( stonesoup_trace , variable_unsigned_integral , "*stonesoup_ptr" , * stonesoup_ptr , stonesoup_ptr , "INITIAL-STATE" ); stonesoup_byte_3 = ( ( char * ) ( stonesoup_ptr + 2 ) ); stonesoup_byte_4 = ( ( char * ) ( stonesoup_ptr + 3 ) ); tracepoint ( stonesoup_trace , variable_address , "stonesoup_byte_3" , stonesoup_byte_3 , "CROSSOVER-STATE" ); tracepoint ( stonesoup_trace , variable_address , "stonesoup_byte_4" , stonesoup_byte_4 , "CROSSOVER-STATE" ); * stonesoup_byte_3 = 0; * stonesoup_byte_4 = 0; stonesoup_printf ( "Value = %i\n" , stonesoup_input_num ); void stonesoup_printf(char * format, ...) va_start ( argptr , format ); mg_vprintf_data ( ( struct mg_connection * ) stonesoup_printf_context , format , argptr ); if ( strlen ( enwinding_acephala ) == 0 )  if ( nonpartisans_decadron != 0 )  free ( ( ( char * ) nonpartisans_decadron ) ); 