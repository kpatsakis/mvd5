 proto_item_fill_label(field_info *fi, gchar *label_str) header_field_info * hfinfo ; if ( ! fi )  hfinfo = fi -> hfinfo; switch ( hfinfo -> type )  fill_label_number ( fi , label_str , FALSE ); static fill_label_number(field_info *fi, gchar *label_str, gboolean is_signed) header_field_info * hfinfo = fi -> hfinfo ; guint32 value ; char buf [ 32 ] ; const char * out ; if ( is_signed )  value = fvalue_get_sinteger ( & fi -> value ); value = fvalue_get_uinteger ( & fi -> value ); if ( hfinfo -> display == BASE_CUSTOM )  if ( hfinfo -> strings && hfinfo -> type != FT_FRAMENUM )  const char * val_str = hf_try_val_to_str_const ( value , hfinfo , "Unknown" ) ; static const char hf_try_val_to_str_const(guint32 value, const header_field_info *hfinfo, const char *unknown_str) const char * str = hf_try_val_to_str ( value , hfinfo ) ; static const char hf_try_val_to_str(guint32 value, const header_field_info *hfinfo) if ( hfinfo -> display & BASE_RANGE_STRING )  return try_rval_to_str ( value , ( const range_string * ) hfinfo -> strings ) ; if ( hfinfo -> display & BASE_EXT_STRING )  return try_val_to_str_ext ( value , ( value_string_ext * ) hfinfo -> strings ) ; if ( hfinfo -> display & BASE_VAL64_STRING )  return try_val64_to_str ( value , ( const val64_string * ) hfinfo -> strings ) ; return try_val_to_str ( value , ( const value_string * ) hfinfo -> strings ) ; return ( str ) ? str : unknown_str ; out = hfinfo_number_vals_format ( hfinfo , buf , value ); static const char hfinfo_number_vals_format(const header_field_info *hfinfo, char buf[32], guint32 value) int display = hfinfo -> display & FIELD_DISPLAY_E_MASK ; if ( display == BASE_NONE )  return NULL ; if ( display == BASE_DEC_HEX )  display = BASE_DEC; if ( display == BASE_HEX_DEC )  display = BASE_HEX; return hfinfo_number_value_format_display ( hfinfo , display , buf , value ) ; if ( out == NULL )  label_fill ( label_str , 0 , hfinfo , val_str ); static label_fill(char *label_str, gsize pos, const header_field_info *hfinfo, const char *text) gsize name_pos ; name_pos = pos = label_concat ( label_str , pos , hfinfo -> name ); pos = label_concat ( label_str , pos , ": " ); pos = label_concat ( label_str , pos , text ? text : "(null)" ); if ( pos >= ITEM_LABEL_LENGTH )  label_mark_truncated ( label_str , name_pos ); static label_mark_truncated(char *label_str, gsize name_pos) static const char trunc_str [ ] = " [truncated]" ; const size_t trunc_len = sizeof ( trunc_str ) - 1 ; if ( name_pos < ITEM_LABEL_LENGTH - trunc_len )  memmove ( label_str + name_pos + trunc_len , label_str + name_pos , ITEM_LABEL_LENGTH - name_pos - trunc_len ); memcpy ( label_str + name_pos , trunc_str , trunc_len ); last_char = g_utf8_prev_char ( & label_str [ ITEM_LABEL_LENGTH ] ); * last_char = '\0'; g_strlcpy ( label_str + name_pos , trunc_str , ITEM_LABEL_LENGTH - name_pos ); 