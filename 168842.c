static CVE_2015_0833_VULN_UpdateThreadFunc(void *param) int rv ; if ( sReplaceRequest )  rv = ProcessReplaceRequest ( ); NS_tchar dataFile [ MAXPATHLEN ] ; rv = GetUpdateFileName ( dataFile , sizeof ( dataFile ) / sizeof ( dataFile [ 0 ] ) ); if ( rv == OK )  rv = gArchiveReader . Open ( dataFile ); if ( rv == OK )  rv = gArchiveReader . VerifySignature ( ); if ( rv == OK )  if ( rv == OK )  NS_tchar updateSettingsPath [ MAX_TEXT_LEN ] ; MARChannelStringTable MARStrings ; if ( ReadMARChannelIDs ( updateSettingsPath , & MARStrings ) != OK )  MARStrings . MARChannelID [ 0 ] = '\0'; rv = gArchiveReader . VerifyProductInformation ( MARStrings . MARChannelID , MOZ_APP_VERSION ); if ( rv == OK && sStagedUpdate && ! sIsOSUpdate )  rv = CopyInstallDirToDestDir ( ); if ( rv == OK )  rv = DoUpdate ( ); if ( sReplaceRequest && rv && ! getenv ( "MOZ_NO_REPLACE_FALLBACK" ) )  