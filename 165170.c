static int CVE_2010_3875_VULN_ax25_getname(struct socket *sock, struct sockaddr int *uaddr_len, int peer) struct full_sockaddr_ax25 * fsa = ( struct full_sockaddr_ax25 * ) uaddr ; struct sock * sk = sock -> sk ; ax25_cb * ax25 ; ax25 = ax25_sk ( sk ); if ( peer != 0 )  fsa -> fsa_ax25 . sax25_family = AF_AX25; fsa -> fsa_ax25 . sax25_call = ax25 -> source_addr; fsa -> fsa_ax25 . sax25_ndigis = 1; if ( ax25 -> ax25_dev != NULL )  memcpy ( & fsa -> fsa_digipeater [ 0 ] , ax25 -> ax25_dev -> dev -> dev_addr , AX25_ADDR_LEN ); 