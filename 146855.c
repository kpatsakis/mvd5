static int CVE_2011_2987_VULN_GrowAtomTable(AtomTable *atable, int size) int * newmap , * newrev ; if ( atable -> size < size )  if ( atable -> amap )  newmap = realloc ( atable -> amap , sizeof ( int ) * size ); newrev = realloc ( atable -> arev , sizeof ( int ) * size ); newmap = malloc ( sizeof ( int ) * size ); newrev = malloc ( sizeof ( int ) * size ); atable -> size = 0; if ( ! newmap || ! newrev )  memset ( & newrev [ atable -> size ] , 0 , ( size - atable -> size ) * sizeof ( int ) ); 