 CVE_2013_1672_PATCHED_ProcessSoftwareUpdateCommand(DWORD argc, LPWSTR *argv) if ( argc < 3 )  WCHAR installDir [ MAX_PATH + 1 ] = L '\0' if ( ! GetInstallationDir ( argc , argv , installDir ) )  BOOL isLocal = FALSE ; if ( ! IsLocalFile ( argv [ 0 ] , isLocal ) || ! isLocal )  nsAutoHandle noWriteLock ( CreateFileW ( argv [ 0 ] , GENERIC_READ , FILE_SHARE_READ , NULL , OPEN_EXISTING , 0 , NULL ) ) ; if ( INVALID_HANDLE_VALUE == noWriteLock )  WCHAR installDirUpdater [ MAX_PATH + 1 ] = L '\0' wcsncpy ( installDirUpdater , installDir , MAX_PATH ); if ( ! PathAppendSafe ( installDirUpdater , L "updater.exe" ) ) if ( result && ! VerifySameFiles ( argv [ 0 ] , installDirUpdater , updaterIsCorrect ) )  LOG_WARN ( ( "Error checking if the updaters are the "Path 1: %ls\nPath 2: %ls" , argv [ 0 ] , installDirUpdater ) ) 