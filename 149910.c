static CVE_2007_6151_PATCHED_isdn_ioctl(struct inode *inode, struct file *file, uint cmd, ulong arg) uint minor = iminor ( inode ) ; int i ; void __user * argp = ( void __user * ) arg ; if ( minor == ISDN_MINOR_STATUS )  switch ( cmd )  if ( arg )  int i ; if ( ! dev -> drivers )  if ( minor <= ISDN_MINOR_BMAX )  if ( minor <= ISDN_MINOR_CTRLMAX )  switch ( cmd )  if ( arg )  dev -> global_flags &= ~ISDN_GLOBAL_STOPPED; if ( arg )  int i ; if ( copy_from_user ( & iocts , argp , sizeof ( isdn_ioctl_struct ) ) )  iocts . drvid [ sizeof ( iocts . drvid ) - 1 ] = 0; if ( strlen ( iocts . drvid ) )  for (i = 0; i < ISDN_MAX_DRIVERS; i++) if ( ! ( strcmp ( dev -> drvid [ i ] , iocts . drvid ) ) )  