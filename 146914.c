static int airspy_s_ctrl(struct v4l2_ctrl *ctrl) struct airspy * s = container_of ( ctrl -> handler , struct airspy , hdl ) int ret ; switch ( ctrl -> id )  ret = airspy_set_mixer_gain ( s ); static int airspy_set_mixer_gain(struct airspy *s) int ret ; ret = airspy_ctrl_msg ( s , CMD_SET_MIXER_AGC , 0 , s -> mixer_gain_auto -> val , & u8tmp , 1 ); if ( ret )  if ( s -> mixer_gain_auto -> val == false )  ret = airspy_ctrl_msg ( s , CMD_SET_MIXER_GAIN , 0 , s -> mixer_gain -> val , & u8tmp , 1 ); static int airspy_ctrl_msg(struct airspy *s, u8 request, u16 value, u16 u8 *data, u16 size) u8 requesttype ; switch ( request )  requesttype = ( USB_TYPE_VENDOR | USB_DIR_OUT ); requesttype = ( USB_TYPE_VENDOR | USB_DIR_IN ); if ( ! ( requesttype & USB_DIR_IN ) )  memcpy ( s -> buf , data , size ); ret = usb_control_msg ( s -> udev , pipe , request , requesttype , value , index , s -> buf , size , 1000 ); airspy_dbg_usb_control_msg ( s -> dev , request , requesttype , value , index , s -> buf , size ); if ( ret < 0 )  dev_err ( s -> dev , "usb_control_msg() failed %d request %02x\n" , ret , request ); memcpy ( data , s -> buf , size ); return ret ; 