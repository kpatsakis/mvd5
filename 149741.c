const gchar proto_custom_set(proto_tree* tree, GSList *field_ids, gint gchar *result, gchar *expr, const int size) int len , prev_len = 0 , last , i , offset_r = 0 , offset_e = 0 ; GPtrArray * finfos ; header_field_info * hfinfo ; int * field_idx ; int ii = 0 ; while ( field_idx = ( int * ) g_slist_nth_data ( field_ids , ii ++ ) )  if ( ! hfinfo )  while ( hfinfo )  finfos = proto_get_finfo_ptr_array ( tree , hfinfo -> id ); GPtrArray proto_get_finfo_ptr_array(const proto_tree *tree, const int id) if ( ! tree )  return NULL ; if ( PTREE_DATA ( tree ) -> interesting_hfids != NULL )  return ( GPtrArray * ) g_hash_table_lookup ( PTREE_DATA ( tree ) -> interesting_hfids , GINT_TO_POINTER ( id ) ) ; return NULL ; if ( ! finfos || ! ( len = g_ptr_array_len ( finfos ) ) )  if ( occurrence < 0 )  hfinfo = hfinfo -> same_name_next; hfinfo = hfinfo_same_name_get_prev ( hfinfo ); static header_field_info hfinfo_same_name_get_prev(const header_field_info *hfinfo) header_field_info * dup_hfinfo ; if ( hfinfo -> same_name_prev_id == - 1 )  return NULL ; return dup_hfinfo ; if ( ( ( occurrence - prev_len ) > len ) || ( ( occurrence + prev_len ) < - len ) )  if ( occurrence < 0 )  hfinfo = hfinfo -> same_name_next; hfinfo = hfinfo_same_name_get_prev ( hfinfo ); static header_field_info hfinfo_same_name_get_prev(const header_field_info *hfinfo) header_field_info * dup_hfinfo ; if ( hfinfo -> same_name_prev_id == - 1 )  return NULL ; return dup_hfinfo ; prev_len += len; if ( occurrence < 0 )  i = occurrence + len + prev_len; last = i; if ( occurrence > 0 )  i = occurrence - 1 - prev_len; last = i; i = 0; last = len - 1; prev_len += len; while ( i <= last )  if ( offset_r && ( offset_r < ( size - 2 ) ) )  result [ offset_r ++ ] = ','; switch ( hfinfo -> type )  if ( offset_r == 0 )  result [ 0 ] = '\0'; if ( result [ offset_r - 1 ] == ',' )  result [ offset_r - 1 ] = '\0'; g_strlcpy ( result , "Yes" , size ); offset_r += protoo_strlcpy ( result + offset_r , str , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , "<MISSING>" , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , tmpbuf , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , tmpbuf , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , number ? tfstring -> true_string : tfstring -> false_string , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , tmp , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , number_out , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , number_out , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , tmp , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , number_out , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , number_out , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , str , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; address_to_str_buf ( & addr , result + offset_r , size - offset_r ); offset_r = ( int ) strlen ( result ); address_to_str_buf ( & addr , result + offset_r , size - offset_r ); offset_r = ( int ) strlen ( result ); address_to_str_buf ( & addr , result + offset_r , size - offset_r ); offset_r = ( int ) strlen ( result ); address_to_str_buf ( & addr , result + offset_r , size - offset_r ); offset_r = ( int ) strlen ( result ); offset_r += protoo_strlcpy ( result + offset_r , str , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , str , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , str , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; offset_r += protoo_strlcpy ( result + offset_r , str , size - offset_r ); static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; g_snprintf ( result + offset_r , size - offset_r "%." G_STRINGIFY ( FLT_DIG ) "g" , fvalue_get_floating ( & finfo -> value ) ) g_snprintf ( result + offset_r , size - offset_r "%." G_STRINGIFY ( DBL_DIG ) "g" , fvalue_get_floating ( & finfo -> value ) ) offset_r = ( int ) strlen ( result ); offset_r += protoo_strlcpy ( result + offset_r , hfinfo_format_text ( hfinfo , bytes ) , size - offset_r ); static const char hfinfo_format_text(const header_field_info *hfinfo, const guchar *string) switch ( hfinfo -> display )  return format_text ( string , strlen ( string ) ) ; return string ; return format_text ( string , strlen ( string ) ) ; static protoo_strlcpy(gchar *dest, const gchar *src, gsize dest_size) gsize res = g_strlcpy ( dest , src , dest_size ) ; if ( res > dest_size )  res = dest_size; return ( int ) res ; i ++; if ( occurrence == 0 )  hfinfo = hfinfo_same_name_get_prev ( hfinfo ); static header_field_info hfinfo_same_name_get_prev(const header_field_info *hfinfo) if ( hfinfo -> same_name_prev_id == - 1 )  PROTO_REGISTRAR_GET_NTH ( hfinfo -> same_name_prev_id , dup_hfinfo ); hfinfo = NULL; 