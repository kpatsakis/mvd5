int CVE_2011_1010_VULN_mac_partition(struct parsed_partitions *state) unsigned char * data ; int blk , blocks_in_map ; unsigned secsize ; struct CVE_2011_1010_VULN_mac_partition * part ; struct mac_driver_desc * md ; md = read_part_sector ( state , 0 , & sect ); if ( ! md )  if ( be16_to_cpu ( md -> signature ) != MAC_DRIVER_MAGIC )  secsize = be16_to_cpu ( md -> block_size ); data = read_part_sector ( state , secsize / 512 , & sect ); if ( ! data )  part = ( struct CVE_2011_1010_VULN_mac_partition * ) ( data + secsize % 512 ); if ( be16_to_cpu ( part -> signature ) != MAC_PARTITION_MAGIC )  blocks_in_map = be32_to_cpu ( part -> map_count ); for (blk = 1; blk <= blocks_in_map; ++blk) int pos = blk * secsize ; data = read_part_sector ( state , pos / 512 , & sect ); if ( ! data )  part = ( struct CVE_2011_1010_VULN_mac_partition * ) ( data + pos % 512 ); if ( be16_to_cpu ( part -> signature ) != MAC_PARTITION_MAGIC )  if ( machine_is ( powermac ) )  if ( strcasecmp ( part -> type , "Apple_UNIX_SVR2" ) == 0 || ( strnicmp ( part -> type , "Linux" , 5 ) == 0 && strcasecmp ( part -> type , "Linux_swap" ) != 0 ) )  int i , l ; l = strlen ( part -> name ); for (i = 0; i <= l - 4; ++i) 