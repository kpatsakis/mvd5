static int CVE_2011_2909_VULN_do_devinfo_ioctl(struct comedi_device struct comedi_devinfo __user struct file *file) struct comedi_devinfo devinfo ; memset ( & devinfo , 0 , sizeof ( devinfo ) ); devinfo . version_code = COMEDI_VERSION_CODE; devinfo . n_subdevs = dev -> n_subdevices; memcpy ( devinfo . driver_name , dev -> driver -> driver_name , COMEDI_NAMELEN ); memcpy ( devinfo . board_name , dev -> board_name , COMEDI_NAMELEN ); devinfo . read_subdevice = read_subdev - dev -> subdevices; devinfo . write_subdevice = write_subdev - dev -> subdevices; devinfo . write_subdevice = - 1; if ( copy_to_user ( arg , & devinfo , sizeof ( struct comedi_devinfo ) ) )  