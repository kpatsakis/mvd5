static int CVE_2012_6542_VULN_llc_ui_getname(struct socket *sock, struct sockaddr int *uaddrlen, int peer) struct sockaddr_llc sllc ; struct sock * sk = sock -> sk ; struct llc_sock * llc = llc_sk ( sk ) ; if ( sock_flag ( sk , SOCK_ZAPPED ) )  if ( peer )  if ( ! llc -> sap )  sllc . sllc_sap = llc -> sap -> laddr . lsap; if ( llc -> dev )  sllc . sllc_arphrd = llc -> dev -> type; memcpy ( & sllc . sllc_mac , llc -> dev -> dev_addr , IFHWADDRLEN ); sllc . sllc_family = AF_LLC; memcpy ( uaddr , & sllc , sizeof ( sllc ) ); 