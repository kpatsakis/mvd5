static cgiParseResultType cgiParsePostFormInput() char * input ; if ( ! cgiContentLength )  input = ( char * ) malloc ( cgiContentLength ); if ( ! input )  if ( ( ( int ) fread ( input , 1 , cgiContentLength , cgiIn ) ) != cgiContentLength )  result = cgiParseFormInput ( input , cgiContentLength ); static cgiParseResultType cgiParseFormInput(char *data, int length) while ( pos != length )  while ( pos != length )  if ( data [ pos ] == '=' )  if ( cgiUnescapeChars ( & attr , data + start , len ) != cgiUnescapeSuccess )  cgiUnescapeResultType cgiUnescapeChars(char **sp, char *cp, int len) s = ( char * ) malloc ( len + 1 ); if ( ! s )  while ( srcPos < len )  int ch = cp [ srcPos ] ; if ( ch == '%' )  if ( ch == '+' )  s [ dstPos ++ ] = ' '; s [ dstPos ++ ] = ch; escapedValue = cgiHexValue [ ch ] << 4; escapedValue += cgiHexValue [ ch ]; s [ dstPos ++ ] = escapedValue; s [ dstPos ] = '\0'; * sp = s; while ( pos != length )  if ( data [ pos ] == '&' )  if ( cgiUnescapeChars ( & value , data + start , len ) != cgiUnescapeSuccess )  cgiUnescapeResultType cgiUnescapeChars(char **sp, char *cp, int len) s = ( char * ) malloc ( len + 1 ); if ( ! s )  while ( srcPos < len )  int ch = cp [ srcPos ] ; if ( ch == '%' )  if ( ch == '+' )  s [ dstPos ++ ] = ' '; s [ dstPos ++ ] = ch; escapedValue = cgiHexValue [ ch ] << 4; escapedValue += cgiHexValue [ ch ]; s [ dstPos ++ ] = escapedValue; s [ dstPos ] = '\0'; * sp = s; free ( input ); return result ; 