static dissect_catapult_dct2000(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree) gint offset = 0 ; gint context_length ; gint protocol_length ; gint timestamp_length ; gint variant_length ; const char * variant_string ; gint outhdr_length ; guint8 direction ; const char * protocol_name ; offset += context_length; offset ++; offset += timestamp_length; protocol_name = tvb_get_const_stringz ( tvb , offset , & protocol_length ); offset += protocol_length; variant_string = tvb_get_const_stringz ( tvb , offset , & variant_length ); offset += variant_length; offset += outhdr_length; direction = tvb_get_guint8 ( tvb , offset ); if ( ( strcmp ( protocol_name , "fp" ) == 0 ) || ( strncmp ( protocol_name , "fp_r" , 4 ) == 0 ) || ( strcmp ( protocol_name , "fpiur_r5" ) == 0 ) )  attach_fp_info ( pinfo , direction , protocol_name , atoi ( variant_string ) ); static void attach_fp_info(packet_info *pinfo, gboolean received, const char *protocol_name, int variant) int i = 0 ; gint node_type ; int calculated_variant ; struct fp_info * p_fp_info = ( struct fp_info * ) p_get_proto_data ( wmem_file_scope ( ) , pinfo , proto_fp , 0 ) ; if ( p_fp_info != NULL )  p_fp_info = wmem_new0 ( wmem_file_scope ( ) , struct fp_info ) if ( ( ( strcmp ( protocol_name , "fpiur_r5" ) == 0 ) && ( outhdr_values_found != 2 ) ) || ( outhdr_values_found < 5 ) )  if ( strcmp ( protocol_name , "fp" ) == 0 )  p_fp_info -> release = 99; if ( strcmp ( protocol_name , "fp_r4" ) == 0 )  p_fp_info -> release = 4; if ( strcmp ( protocol_name , "fp_r5" ) == 0 )  p_fp_info -> release = 5; if ( strcmp ( protocol_name , "fp_r6" ) == 0 )  p_fp_info -> release = 6; if ( strcmp ( protocol_name , "fp_r7" ) == 0 )  p_fp_info -> release = 7; if ( strcmp ( protocol_name , "fp_r8" ) == 0 )  p_fp_info -> release = 8; if ( strcmp ( protocol_name , "fpiur_r5" ) == 0 )  p_fp_info -> release = 5; switch ( p_fp_info -> release )  if ( variant < 256 )  calculated_variant = variant; calculated_variant = variant / 256; switch ( calculated_variant )  p_fp_info -> release_year = 2005; p_fp_info -> release_month = 6; p_fp_info -> release_year = 2005; p_fp_info -> release_month = 9; p_fp_info -> release_year = 2006; p_fp_info -> release_month = 3; p_fp_info -> release_year = 2008; p_fp_info -> release_month = 3; p_fp_info -> release_year = 2010; p_fp_info -> release_month = 6; p_fp_info -> release_year = 0; p_fp_info -> release_month = 0; p_fp_info -> channel = outhdr_values [ i ++ ]; if ( p_fp_info -> channel == 0 )  p_fp_info -> channel = CHANNEL_DCH; node_type = outhdr_values [ i ++ ]; p_fp_info -> is_uplink = ( ( received && ( node_type == 2 ) ) || ( ! received && ( node_type == 1 ) ) ); if ( ( p_fp_info -> release == 7 ) || ( p_fp_info -> release == 8 ) )  p_fp_info -> division = ( enum division_type ) outhdr_values [ i ++ ]; if ( p_fp_info -> channel == CHANNEL_HSDSCH )  if ( ( p_fp_info -> release == 7 ) || ( p_fp_info -> release == 8 ) )  if ( outhdr_values [ i ++ ] )  if ( strcmp ( protocol_name , "fpiur_r5" ) == 0 )  p_fp_info -> dch_crc_present = outhdr_values [ i ++ ]; if ( p_fp_info -> channel == CHANNEL_EDCH )  p_fp_info -> dch_crc_present = 2; p_fp_info -> paging_indications = outhdr_values [ i ++ ]; p_fp_info -> num_chans = outhdr_values [ i ++ ]; if ( p_fp_info -> channel == CHANNEL_EDCH_COMMON )  p_fp_info -> edch_type = 1; if ( p_fp_info -> channel != CHANNEL_EDCH )  if ( strcmp ( protocol_name , "fp_r8" ) == 0 )  