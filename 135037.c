ram_addr_t qemu_ram_alloc(ram_addr_t size, MemoryRegion *mr) return qemu_ram_alloc_from_ptr ( size , NULL , mr ) ; ram_addr_t qemu_ram_alloc_from_ptr(ram_addr_t size, void MemoryRegion *mr) RAMBlock * block , * new_block ; size = TARGET_PAGE_ALIGN ( size ); new_block = g_malloc0 ( sizeof ( * new_block ) ); if ( host )  if ( mem_path )  new_block -> host = file_ram_alloc ( new_block , size , mem_path ); static void *file_ram_alloc(RAMBlock ram_addr_t const char *path) unsigned long hpagesize ; hpagesize = gethugepagesize ( path ); static long gethugepagesize(const char *path) struct statfs fs ; int ret ; ret = statfs ( path , & fs ); while ( ret != 0 && errno == EINTR )  if ( ret != 0 )  if ( fs . f_type != HUGETLBFS_MAGIC )  fprintf ( stderr , "Warning: path not on HugeTLBFS: %s\n" , path ); 